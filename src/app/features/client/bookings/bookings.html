<div class="space-y-10">
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div>
      <h1 class="font-serif text-3xl font-light text-charcoal">Mes reservations</h1>
      <p class="font-sans text-sm text-stone font-light mt-2">Gerer toutes vos reservations</p>
    </div>
    <div class="flex gap-2">
      <button
        (click)="onStatusChange('all')"
        [class]="selectedStatus() === 'all' ? 'border-charcoal text-charcoal' : 'border-sand/50 text-stone'"
        class="px-4 py-2 font-sans text-xs tracking-[0.1em] uppercase border transition-all duration-300 hover:border-charcoal hover:text-charcoal"
      >
        Toutes
      </button>
      <button
        (click)="onStatusChange('PENDING')"
        [class]="selectedStatus() === 'PENDING' ? 'border-warning text-warning' : 'border-sand/50 text-stone'"
        class="px-4 py-2 font-sans text-xs tracking-[0.1em] uppercase border transition-all duration-300 hover:border-warning hover:text-warning"
      >
        En attente
      </button>
      <button
        (click)="onStatusChange('CONFIRMED')"
        [class]="selectedStatus() === 'CONFIRMED' ? 'border-success text-success' : 'border-sand/50 text-stone'"
        class="px-4 py-2 font-sans text-xs tracking-[0.1em] uppercase border transition-all duration-300 hover:border-success hover:text-success"
      >
        Confirmees
      </button>
      <button
        (click)="onStatusChange('CANCELLED')"
        [class]="selectedStatus() === 'CANCELLED' ? 'border-error text-error' : 'border-sand/50 text-stone'"
        class="px-4 py-2 font-sans text-xs tracking-[0.1em] uppercase border transition-all duration-300 hover:border-error hover:text-error"
      >
        Annulees
      </button>
    </div>
  </div>

  @if (loading()) {
    <div class="flex justify-center items-center py-16">
      <div class="w-8 h-8 border border-sand border-t-taupe rounded-full animate-spin"></div>
    </div>
  } @else {
    <div class="border border-linen overflow-hidden">
      <div class="overflow-x-auto">
        <table class="min-w-full">
          <thead>
            <tr class="bg-cream/50">
              <th class="px-6 py-4 text-left font-sans text-xs tracking-[0.1em] uppercase text-stone font-medium">Chambre</th>
              <th class="px-6 py-4 text-left font-sans text-xs tracking-[0.1em] uppercase text-stone font-medium">Date debut</th>
              <th class="px-6 py-4 text-left font-sans text-xs tracking-[0.1em] uppercase text-stone font-medium">Date fin</th>
              <th class="px-6 py-4 text-left font-sans text-xs tracking-[0.1em] uppercase text-stone font-medium">Prix total</th>
              <th class="px-6 py-4 text-left font-sans text-xs tracking-[0.1em] uppercase text-stone font-medium">Statut</th>
              <th class="px-6 py-4 text-left font-sans text-xs tracking-[0.1em] uppercase text-stone font-medium">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-linen">
            @for (booking of getFilteredBookings(); track booking.id) {
              <tr class="hover:bg-cream/30 transition-colors duration-300">
                <td class="px-6 py-4 whitespace-nowrap">
                  <p class="font-serif text-base text-charcoal">Chambre {{ booking.room.roomNumber }}</p>
                  <p class="font-sans text-xs text-stone mt-0.5">{{ booking.room.type }}</p>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <p class="font-sans text-sm text-charcoal">{{ formatDate(booking.startDate) }}</p>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <p class="font-sans text-sm text-charcoal">{{ formatDate(booking.endDate) }}</p>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <p class="font-serif text-base text-gold">{{ booking.totalPrice }} MRU</p>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span [class]="'px-3 py-1 font-sans text-xs tracking-[0.05em] uppercase ' + getStatusBadgeClass(booking.status)">
                    {{ getStatusLabel(booking.status) }}
                  </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  @if (booking.status !== 'CANCELLED') {
                    <button
                      (click)="cancelBooking(booking)"
                      class="font-sans text-xs tracking-[0.08em] uppercase text-error hover:text-error/70 transition-colors duration-300"
                    >
                      Annuler
                    </button>
                  }
                </td>
              </tr>
            } @empty {
              <tr>
                <td colspan="6" class="px-6 py-16 text-center">
                  <p class="font-sans text-sm text-stone font-light">Aucune reservation trouvee</p>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  }
</div>
